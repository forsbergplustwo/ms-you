<%= polaris_page(
  title: "Current Symptoms",
  subtitle: "Track your symptoms over time",
) do |page| %>

  <% page.primary_action(url: new_symptom_path) { "New symptom" } %>

  <%= polaris_card do %>
    <%= area_chart([{name: "Severity", data: @symptoms.group_by_day(&:start_date).collect {|d, s| [d, s.sum(&:severity_before_type_cast)]}}]) %>
  <% end %>

  <%= polaris_card do %>
    <%= polaris_data_table(@symptoms) do |table| %>
      <% table.column("Title") do |symptom| %>
        <%= symptom.title %>
      <% end %>
      <% table.column("Description") do |symptom| %>
        <%= symptom.description %>
      <% end %>
      <% table.column("Severity") do |symptom| %>
        <%= symptom.severity %>
      <% end %>
      <% table.column("Actions") do |symptom| %>
        <%= polaris_button(url: symptom_path(symptom)) { "View" } %>
      <% end %>
    <% end %>
  <% end %>

<% end %>
